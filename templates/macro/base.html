{% import "macro/insert.html" as insert %}
{% import "macro/blog.html" as blog %}


{% macro head() %}
{#- Page title #}
{%- set title = config.title | default(value='‚ö†Ô∏è No Title for this language') %}
{%- if page.title %}
{%- set title = title ~ ' &middot; ' ~ page.title | safe %}
{%- endif %}

{#- Page description #}
{%- set description = config.description | default(value=page.description) %}

{#- Timestamp #}
{%- set updated_time = now(utc = true) | date(format = '%+') %}
{%- set local_time = now(utc = false) | date(format = '%Y-%m-%d %H:%M') %}

<!-- Generated: {{ local_time }} -->

<!-- base::head() -->
<head>
	<meta charset="UTF-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0" />
	<meta property="og:updated_time" content="{{ updated_time }}" />

	{#- Title #}
	<title>{{ title | safe }}</title>
	<meta property="og:title" content="{{ title | safe }}">

	{#- Progressive Web Application #}
	<meta name="apple-mobile-web-app-capable" content="yes">
	<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

	{#- Description #}
	<meta name="description" content="{{ description }}" />
	<meta property="og:description" content="{{ description }}">

	{#- Application icon #}
	<link rel="icon" sizes="any" href="{{ get_url(path='appicon/favicon.ico', cachebust = true) }}" />
	<link rel="apple-touch-icon" href="{{ get_url(path='appicon/icon-180x180.png', cachebust = true) }}" />
	<link rel="manifest" href="{{ get_url(path='appicon/manifest.json', cachebust = true) }}" />
	<link rel="icon" type="image/svg+xml" href="{{ get_url(path='appicon/icon.svg', cachebust = true) }}" />

	{#- Stylesheet #}
	<link rel="stylesheet" href="{{ get_url(path='css/vyolet.css', cachebust = true) }}" />

	{#- Markdown highlighter #}
	{%- if config.markdown.highlight_code %}
	<link id="syntax_highlight" href="#" rel="stylesheet">
	{% endif %}

	{#- Scripts -#}
	<script src="{{ get_url(path='js/vyolet.js', cachebust = true) }}"></script>

	{#- Plausible #}
	{{ self::plausible() }}

	{#- Javascript for the 404 page #}
	{{- self::js_unhide_native() }}

	{#- Feed #}
	{%- if config.generate_feed %}
	<link rel="alternate" type="application/atom+xml" title="RSS" href="{{ get_url(path='atom.xml') | safe }}">
	{%- endif %}
</head>
<!-- /base::head -->

{% endmacro head %}


{% macro navbar(padding) %}
{#- If padding is true: use the "section" class to add padding below the navbar -#}
<!-- base::navbar() -->
<header class="header">
{%- if padding %}<section class="section">{% endif %}
<nav class="navbar is-fixed-top is-hoverable has-shadow" aria-label="main navigation">

<!-- navbar-brand -->
<div class="navbar-brand">

	<!-- Logo -->
	<a class="navbar-item" href="{{ config.base_url | safe }}">
		{{ insert::logotype(header = true) }}</a>
	<!-- /Logo -->

	<!-- Burger -->
	<a role="button" class="navbar-burger" aria-label="menu" aria-expanded="false"
	data-target="navbarMenu"><span aria-hidden="true"></span>
	<span aria-hidden="true"></span><span aria-hidden="true"></span></a>
	<!-- /Burger -->

</div>
<!-- /navbar-brand -->

<!-- navbar-menu -->
<div id="navbarMenu" class="navbar-menu">
	<!-- navbar-start -->
	<div class="navbar-start">
	{%- if config.extra.header_menu %}
		{%- for item in config.extra.header_menu %}
			{%- set navbar_item_class = 'navbar-item' %}
			{%- if current_path is defined and current_path is containing(item.url) %}
				{%- set navbar_item_class = 'navbar-item is-active' %}
			{%- endif %}
			<a class="{{ navbar_item_class }}" href="{{ get_url(path=item.url) }}">{{ trans(key=item.url, lang=lang) }}</a>
		{%- endfor %}
	{%- endif %}
	</div>
	<!-- /navbar-start -->

	<!-- /search-container -->
	{%- if config.build_search_index %}
		<div class="navbar-item search-container js-only">
			<input class="input" id="search" type="search" placeholder="Search">
			<div class="search-results box">
				<div class="search-results__items"></div>
			</div><!-- /search-results -->
		</div>
	{%- endif %}
	<!-- /search-container -->

	<!-- navbar-end -->
	<div class="navbar-end">

	<!-- language-switcher -->
	{%- if config.extra.header_languages is defined %}
		{%- set url = current_path | default(value = "") %}
		{%- set url = url | replace(from=lang, to="") %}
		{%- set url = url | replace(from="//", to="/") %}
		<!-- {{ url }} -->
	{%- endif %}
	<div class="navbar-item has-dropdown is-hoverable">
		<a class="navbar-link is-arrowless" href="">{{ insert::icon(image="globe") }}</a>
		<div class="navbar-dropdown is-boxed">
		{%- for language in config.extra.header_languages %}
			{%- set active = "" %}
			{%- if language.lang == lang %}{% set active = "is-active" %}{% endif %}
			<a class="navbar-item {{ active }}" href="{{ get_url(path = url, lang = language.lang, trailing_slash=false) }}">{{ language.name }}</a>
		{%- endfor %}
		</div>
	</div>
	<!-- /language-switcher -->

	<!-- buttons -->
	<div class="navbar-item">
			<div class="buttons">
				<button class="button is-primary" disabled>
					<strong>{{ trans(key="login", lang=lang) }}</strong>
				</button>
			</div><!-- /buttons -->
		</div><!-- /navbar-item -->
	</div>
	<!-- /buttons -->

	<!-- /navbar-end -->

</div>
<!-- /navbar-menu -->

</nav>
{%- if padding %}</section>{% endif %}
</header>
<!-- /base::navbar -->
{% endmacro navbar %}


{%- macro plausible() %}
<!-- base::plausible() -->
{%- if config.extra.plausible %}
{%- set plausible_script_path = config.extra.plausible_script_path | default(value='https://plausible.io/js/script.js') %}
<script defer data-domain="{{ config.extra.plausible }}" src="{{ plausible_script_path | safe }}" crossorigin="anonymous"></script>
	{%- if current_path is undefined %}
	<script>window.plausible = window.plausible || function() { (window.plausible.q = window.plausible.q || []).push(arguments) }</script>
	{%- endif %}
{%- endif %}
<!-- /base::plausible -->
{% endmacro plausible -%}


{% macro footer() %}
<!-- base::footer() -->
<footer class="footer">
<div class="columns is-flex-direction-row-reverse">

<!-- column 3 -->
<div class="column">
	<p class="menu-label">Project</p>
	<ul class="menu-list">
		<li><a href="{{ get_url(path='about') | safe }}">About</a></li>
		<li><a href="{{ get_url(path='blog') | safe }}">Blog</a></li>
	</ul>
</div>
<!-- /column 3 -->

<!-- column 2 -->
<div class="column">
	<p class="menu-label">Resources</p>
	<ul class="menu-list">
		<li><a href="{{ get_url(path='docs') | safe }}">Documentation</a></li>
		{%- if config.extra.status %}
		<li><a href="{{ config.extra.status | safe }}">Status</a></li>
		{%- endif -%}
	</ul>
</div>
<!-- /column 2 -->

<!-- column 4 -->
<div class="column">
	<p class="menu-label">{{ trans(key="follow_us", lang=lang) }}</p>
	<p class="is-size-4">
		{%- if config.extra.linkedin %}
		<a href="https://www.linkedin.com/{{ config.extra.linkedin }}" rel="me">{{ insert::icon(image="linkedin") }}</a>
		{% endif -%}

		{%- if config.extra.github %}
		<a href="https://github.com/{{ config.extra.github }}" rel="me">{{ insert::icon(image="github") }}</a>
		{% endif -%}

		{%- if config.extra.mastodon %}
		<a href="{{ config.extra.mastodon | safe }}" rel="me">{{ insert::icon(image="mastodon") }}</a>
		{% endif -%}

		{%- if config.generate_feed %}
		<a href="{{ get_url(path='atom.xml') | safe }}">{{ insert::icon(image="rss") }} </a>
		{% endif -%}

		{%- if config.extra.mailto %}
		<a href="mailto:{{ config.extra.mailto }}">{{ insert::icon(image="mail") }} </a>
		{%- endif %}
	</p>
</div>
<!-- /column 4 -->

<!-- column 1 -->
<div class="column">
	<p class="has-text-centered is-size-3">
		<span class="icon-text">
			<span class="logotype">{{ insert::icon(image="logo") }}{{ config.title }}</span>
		</span>
	</p>
	<p class="has-text-centered is-size-7">
		<a href="{{ get_url(path='privacy', lang=lang) }}">{{ trans(key="privacy", lang=lang) }}</a> &amp;
		<a href="{{ get_url(path='security', lang=lang) }}">{{ trans(key="security", lang=lang) }}</a>
	</p>
	<p class="has-text-centered is-size-7">Made with üíú</p>
	<p class="has-text-centered is-size-7"><a href="https://www.infomaniak.com/goto/en/home?utm_term=617a889a54450">Hosted in üá®üá≠ by Infomaniak</a></p>
</div>
<!-- /column 1 -->

</div><!-- /columns -->
</footer>
<!-- /base::footer -->
{% endmacro footer %}


{% macro js_unhide_native() %}
{%- if current_path is undefined %}
<script>
// This is injected into the HTML head only when a non-templated page is
// generated, typically a static 404 page. This script will unhide the
// native language div if the browser language matches the language of
// the page, and hide the English div.

document.addEventListener("DOMContentLoaded", function() {
	// Get the language code of the browser
	const language = navigator.language;

	// Remove the region and lowercase the language code.
	const language_code = language.split('-')[0].toLowerCase();

	// Get the language elements with the user's language (<div lang="##">).
	const language_elements = document.querySelectorAll(`div[lang="${language_code}"]`);

	// Loop through the elements and unhide them.
	language_elements.forEach((element) => {
		element.classList.remove('is-hidden');
	});

	// Hide the English div if another div is unhidden.
	if (language_elements.length > 0 && language_code !== 'en') {
		document.querySelector('div[lang="en"]').classList.add('is-hidden');
	}
});
// https://plausible.io/docs/error-pages-tracking-404
// {%- if config.extra.plausible %}
plausible("404", {props: {path: document.location.pathname} });
// {%- endif %}
</script>
{%- endif %}
{% endmacro js_unhide_native %}

